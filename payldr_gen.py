##
# HBot - Orchestrated bot
#
# @package intrd/pentest-hbot
# @version 
# @tags pentest, bot, eggdrop, pyton, bash
# @link http://github.com/intrd/pentest-hbot
# @author intrd (Danilo Salles) - http://dann.com.br
# @copyright (CC-BY-SA-4.0) 2016, intrd
# @license Creative Commons Attribution-ShareAlike 4.0 - http://creativecommons.org/licenses/by-sa/4.0
# Dependencies: 
# - python >=2.7.0
## @docbloc 1.1

import requests
import sys
import json
import cookielib

def save_cookies_lwp(cookiejar, filename):
    lwp_cookiejar = cookielib.LWPCookieJar()
    for c in cookiejar:
        args = dict(vars(c).items())
        args['rest'] = args['_rest']
        del args['_rest']
        c = cookielib.Cookie(**args)
        lwp_cookiejar.set_cookie(c)
    lwp_cookiejar.save(filename, ignore_discard=True)

def load_cookies_from_lwp(filename):
    lwp_cookiejar = cookielib.LWPCookieJar()
    lwp_cookiejar.load(filename, ignore_discard=True)
    return lwp_cookiejar

pyload = {}
pyload["enabled"] = "1"
pyload["targ"] = "http://xxxxxxx:xxxx/"
pyload["type"] = "GET"
pyload["header"] = {
	"Host": "xxxxxxxxx:xxxxx",
	"User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:50.0) Gecko/20100101 Firefox/50.0",
	"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
	"Accept-Language": "en-US,en;q=0.5",
	"Accept-Encoding": "gzip, deflate",
	"Connection": "keep-alive",
	"Upgrade-Insecure-Requests": "1",
	"Cache-Control": "max-age=0",
	"Cookie": ""
}
pyload["postdata"] = {}

out = json.dumps(pyload)
print out # to printout json

r = requests.session()
r = requests.get(pyload["targ"], data=json.dumps(pyload["postdata"]), headers=pyload["header"])
#save_cookies_lwp(r.cookies, cookiefile) #define cookiefile path to get cookiedata via cmdline
print(r.content)